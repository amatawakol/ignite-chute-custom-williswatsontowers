!function(e){window.Chute||(window.Chute={}),window.Chute.Analytics=function(){"use strict";var e={extend:function(){for(var e=arguments[0],t=arguments.length,r=1;r<t;r++)for(var o in arguments[r])Object.prototype.hasOwnProperty.call(arguments[r],o)&&(e[o]=arguments[r][o]);return e},toString:Object.prototype.toString,isUndefined:function(e){return void 0===e},isFunction:function(e){return"function"==typeof e},isString:function(e){return"string"==typeof e},isArray:function(t){return"[object Array]"===e.toString.call(t)},isObject:function(t){return"[object Object]"===e.toString.call(t)},noop:function(){},each:function(t,r){var o;if(e.isArray(t)){var n=t.length;for(o=-1;++o<n;)r(t[o],o)}else if(e.isObject(t))for(o in t)Object.prototype.hasOwnProperty.call(t,o)&&r(t[o],o)},eachElement:function(t,r){e.isArray(t)||(t=[t]),e.each(t,function(t){var o;if(e.isString(t)){var n=document.querySelectorAll?document.querySelectorAll(t):window.jQuery&&jQuery(t);if(!n)return;for(o=0;o<n.length;o++)r(n[o])}else if(t.length)for(o=0;o<t.length;o++)r(t[o]);else r(t)})},_buildParams:function(t,r,o){e.isArray(r)||e.isObject(r)?e.each(r,function(r,n){/\[\]$/.test(t)?o(t,r):e._buildParams(t+"["+n+"]",r,o)}):o(t,r)},param:function(t){var r=[],o=function(e,t){r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};for(var n in t)e._buildParams(n,t[n],o);return r.join("&").replace(/%20/g,"+")},params:{asset:"aID",album:"lID",product:"pID",campaign:"cID",display:"dID",displayType:"dTp",displayVersion:"dVs",context:"eCx",redirect:"rUrl",url:"eUr"},transformParams:function(t){var r=e.extend({},t);for(var o in r)this.params[o]&&(r[this.params[o]]=r[o],delete r[o]);return r},guid:function(){return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})},storage:{get:function(e){return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*Chute_"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},set:function(e,t){document.cookie="Chute_"+encodeURIComponent(e)+"="+encodeURIComponent(t)+"; expires=Fri, 31 Dec 9999 23:59:59 GMT; path=/"}}};return function(){function t(t,r){this.defaultParams=t||{},this.options=r||{},this.options.url=this.options.url||"https://pixel.getchute.com/x.gif",this.defaultParams.uID=e.storage.get("uID"),this.defaultParams.uID||(this.defaultParams.uID=e.guid(),e.storage.set("uID",this.defaultParams.uID)),this.defaultParams.uSe=e.guid(),this.timeTracking={trackTimeAt:[5,10,20,40,75,150,300,600,900,1200,1500,1800]},e.isUndefined(this.options.autoPageview)&&(this.options.autoPageview=!0),e.isUndefined(this.options.autoTrackTime)&&(this.options.autoTrackTime=!0),this.options.autoPageview&&this.pageview()}function r(e){if(e._trackingTime){var t=e.timeTracking;if(0!==t.viewTimeIndex){if(t.viewTimeIndex<t.trackTimeAt.length){var r=Math.round(((new Date).getTime()-t.lastViewTimeEvent)/1e3);e.trigger("view_time",{sec:r})}t.timeSpentTimer&&clearTimeout(t.timeSpentTimer),t.viewTimeIndex=0;var o=function(){if(!(t.viewTimeIndex>=t.trackTimeAt.length)){var r=t.trackTimeAt[t.viewTimeIndex],n=t.trackTimeAt[t.viewTimeIndex-1]||0,s=r-n;t.timeSpentTimer=setTimeout(function(){e.trigger("view_time",{sec:s}),t.lastViewTimeEvent=(new Date).getTime(),t.viewTimeIndex++,o()},1e3*s)}};o()}}}function o(t,r,o){var n=function(){if(e.isString(o)&&(o={eCx:o}),e.isFunction(o)&&(o=o(r)),!1!==o){o.url=this.href,o.redirect=o.url;var n=this.href;if(t.options.tunnel){for(var s=e.isArray(t.options.tunnel)?t.options.tunnel:[t.options.tunnel],i=r.href,a=s.length-1;a>=0;a--)i=s[a].replace(/\{\{(\s+)?url(\s+)?\}\}/,encodeURIComponent(i));o.redirect=i}o=e.transformParams(e.extend({eTp:"click_url"},t.defaultParams,o||{})),this.href="https://track.getchute.com/?"+e.param(o);var c=this;setTimeout(function(){c.href=n},100)}};r.addEventListener?r.addEventListener("click",n,!1):r.attachEvent&&r.attachEvent("onclick",function(){n.apply(r,arguments)})}return t.prototype.trigger=function(t,o){if(o=e.transformParams(e.extend({eTp:t},this.defaultParams,o||{})),o._=(new Date).getTime(),this.options.debug)window.console&&window.console.log(o);else{var n=new Image;n.onload=o.success||e.noop,n.onerror=o.error||e.noop,n.src=this.options.url+"?"+e.param(o)}"view_time"!==t&&r(this)},t.prototype.pageview=function(e){this._pageview||(this._pageview=!0,e||(e={}),e.url||(e.url=location.href||document.href),this.trigger("view_load",e),this.options.autoTrackTime&&this.trackTime())},t.prototype.trackTime=function(){this._trackingTime=!0,r(this)},t.prototype.trackLink=function(t,r){r||(r={});var n=this;e.eachElement(t,function(e){o(n,e,r)})},t.prototype.trackModel=function(t,r){e.isArray(t)||(t=[t]),r||(r={});var o=this;e.each(t,function(t){t.on("change:hearts",function(t){var n=e.isFunction(r)?r(t):r;if(!1!==n){n.asset=t.get("shortcut");var s=n.success,i=n.error;n.success=function(){s&&s(t)},n.error=function(){i&&i(t)},o.trigger("click_vote",n)}})})},t.prototype.trackHover=function(t,r){r||(r={});var o=this;e.eachElement(t,function(t){var n=r.timeout;if(r=e.extend({},r),e.isString(r)&&(r={eCx:r}),e.isFunction(r)&&(r=r(t)),!1!==r){var s,i=function(){s||(s=setTimeout(function(){delete r.timeout,o.trigger("hover_int",r)},n||1e3))},a=function(){s&&(clearTimeout(s),s=void 0)},c=function(e){return function(r){r.relatedTarget&&(r.relatedTarget===t||(t.contains?t.contains(r.relatedTarget):window.jQuery&&window.jQuery.contains&&window.jQuery.contains(t,r.relatedTarget)))||e()}};t.addEventListener?(t.addEventListener("mouseover",c(i),!1),t.addEventListener("mouseout",c(a),!1)):t.attachEvent&&(t.attachEvent("onmouseover",c(i)),t.attachEvent("onmouseout",c(a)))}})},t}()}(),"function"==typeof define&&define.amd&&define("analytics",[],window.Chute.Analytics)}();